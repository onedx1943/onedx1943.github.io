webpackJsonp([1],{"11Ol":function(t,e){},"3+dM":function(t,e){},"4i06":function(t,e){},"6aIQ":function(t,e){},"75l9":function(t,e){t.exports={_from:"axios",_id:"axios@0.21.4",_inBundle:!1,_integrity:"sha1-xnuQ3AVo5cHPKwuFjEO6KOLtpXU=",_location:"/axios",_phantomChildren:{},_requested:{type:"tag",registry:!0,raw:"axios",name:"axios",escapedName:"axios",rawSpec:"",saveSpec:null,fetchSpec:"latest"},_requiredBy:["#USER","/"],_resolved:"https://registry.nlark.com/axios/download/axios-0.21.4.tgz?cache=0&sync_timestamp=1630942656836&other_urls=https%3A%2F%2Fregistry.nlark.com%2Faxios%2Fdownload%2Faxios-0.21.4.tgz",_shasum:"c67b90dc0568e5c1cf2b0b858c43ba28e2eda575",_spec:"axios",_where:"F:\\python\\github\\GithubPage",author:{name:"Matt Zabriskie"},browser:{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},bugs:{url:"https://github.com/axios/axios/issues"},bundleDependencies:!1,bundlesize:[{path:"./dist/axios.min.js",threshold:"5kB"}],dependencies:{"follow-redirects":"^1.14.0"},deprecated:!1,description:"Promise based HTTP client for the browser and node.js",devDependencies:{coveralls:"^3.0.0","es6-promise":"^4.2.4",grunt:"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",mocha:"^8.2.1",sinon:"^4.5.0","terser-webpack-plugin":"^4.2.3",typescript:"^4.0.5","url-search-params":"^0.10.0",webpack:"^4.44.2","webpack-dev-server":"^3.11.0"},homepage:"https://axios-http.com",jsdelivr:"dist/axios.min.js",keywords:["xhr","http","ajax","promise","node"],license:"MIT",main:"index.js",name:"axios",repository:{type:"git",url:"git+https://github.com/axios/axios.git"},scripts:{build:"NODE_ENV=production grunt build",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",examples:"node ./examples/server.js",fix:"eslint --fix lib/**/*.js",postversion:"git push && git push --tags",preversion:"npm test",start:"node ./sandbox/server.js",test:"grunt test",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json"},typings:"./index.d.ts",unpkg:"dist/axios.min.js",version:"0.21.4"}},"9sXQ":function(t,e){},A4AV:function(t,e){},"J+9v":function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("7+uW"),n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var s=i("VU/8")({name:"App"},n,!1,function(t){i("9sXQ")},null,null).exports,o=i("/ocq"),l={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"home-content"},[e("div",{staticClass:"btn-container"},[e("router-link",{staticClass:"btn",attrs:{to:"/app"}},[this._v("Go to App")]),this._v(" "),e("router-link",{staticClass:"btn",staticStyle:{display:"none"},attrs:{to:"/blog"}},[this._v("Go to Blog")])],1)])},staticRenderFns:[]};var r=i("VU/8")({name:"Home",data:function(){return{}}},l,!1,function(t){i("wI6D")},"data-v-7e95144b",null).exports,c={name:"PageHeader",data:function(){return{github_url:"https://github.com/onedx1943/onedx1943.github.io"}},methods:{switchSidebar:function(){document.querySelector(".page-sidebar").classList.toggle("open")}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page-header"},[i("div",{staticClass:"menu-button"},[i("i",{staticClass:"el-icon-notebook-2",on:{click:function(e){return t.switchSidebar()}}})]),t._v(" "),i("div",{staticClass:"header-container"},[i("div",[i("router-link",{staticClass:"btn",attrs:{to:"/"}},[i("i",{staticClass:"fas fa-vihara"}),t._v(" Home")])],1),t._v(" "),i("div",[i("a",{staticClass:"btn",attrs:{href:t.github_url,target:"_blank"}},[i("i",{staticClass:"fab fa-github"}),t._v(" GitHub")])])])])},staticRenderFns:[]};var d=i("VU/8")(c,u,!1,function(t){i("11Ol")},"data-v-e2c33502",null).exports,m={components:{pageHeader:d},data:function(){return{activeMenu:null,usage:""}},created:function(){this.activeMenu=this.$router.currentRoute.fullPath},mounted:function(){this.refreshUsage()},methods:{switchSidebar:function(){document.querySelector(".page-sidebar").classList.toggle("open")},menuItemSelect:function(t,e){document.querySelector(".page-sidebar").classList.remove("open")},refreshUsage:function(){var t=this;window.navigator.storage.estimate().then(function(e){t.usage=(e.usage/1024/1024).toFixed(2)})}}},p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"page-container"},[i("pageHeader"),t._v(" "),i("div",{staticClass:"page-app"},[i("div",{staticClass:"app-container"},[i("div",{staticClass:"page-sidebar"},[i("div",{staticClass:"page-sidebar-inner"},[i("el-menu",{staticClass:"app-container-menu",attrs:{"default-active":t.activeMenu,router:!0},on:{select:t.menuItemSelect}},[i("el-menu-item",{attrs:{index:"/app/icon"}},[i("i",{staticClass:"el-icon-sugar"}),t._v(" "),i("span",{attrs:{slot:"title"},slot:"title"},[t._v("Icon")])]),t._v(" "),i("el-menu-item",{attrs:{index:"/app/novel"}},[i("i",{staticClass:"el-icon-reading"}),t._v(" "),i("span",{attrs:{slot:"title"},slot:"title"},[t._v("Novels")])]),t._v(" "),i("el-menu-item",{attrs:{index:"/app/music"}},[i("i",{staticClass:"el-icon-headset"}),t._v(" "),i("span",{attrs:{slot:"title"},slot:"title"},[t._v("Music")])]),t._v(" "),i("el-menu-item",{attrs:{index:"/app/picture"}},[i("i",{staticClass:"el-icon-picture-outline"}),t._v(" "),i("span",{attrs:{slot:"title"},slot:"title"},[t._v("Picture")])]),t._v(" "),i("el-menu-item",{attrs:{index:"/app/video"}},[i("i",{staticClass:"el-icon-monitor"}),t._v(" "),i("span",{attrs:{slot:"title"},slot:"title"},[t._v("Video")])]),t._v(" "),i("el-menu-item",{attrs:{index:"/app/work-hour"}},[i("i",{staticClass:"el-icon-date"}),t._v(" "),i("span",{attrs:{slot:"title"},slot:"title"},[t._v("Work Hour")])])],1)],1),t._v(" "),i("div",{staticClass:"usage-label"},[t._v("当前站点使用磁盘空间: "+t._s(t.usage)+" M")])]),t._v(" "),i("div",{staticClass:"app-item-content mini-scroll",on:{click:t.menuItemSelect}},[i("router-view")],1)]),t._v(" "),i("el-backtop",{attrs:{target:".app-item-content","visibility-height":1e3}})],1)],1)},staticRenderFns:[]};var f=i("VU/8")(m,p,!1,function(t){i("p6uz")},"data-v-58c9b5ea",null).exports,v={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"main-content"},[t._v("\n    "+t._s(t.msg)+"\n    "),i("div",{staticClass:"app-index"},t._l(t.apps,function(e){return i("el-card",{key:e.name,attrs:{shadow:"hover","body-style":{padding:"0px"}}},[i("div",{staticClass:"app-card",on:{click:function(i){return t.toPage(e.link)}}},[t._v(t._s(e.name))])])}),1)])},staticRenderFns:[]};var h=i("VU/8")({name:"AppIndex",data:function(){return{apps:[{name:"Icon",link:"/app/icon"},{name:"Novels",link:"/app/novel"},{name:"Music",link:"/app/music"},{name:"Picture",link:"/app/picture"},{name:"Video",link:"/app/video"},{name:"Work Hour",link:"/app/work-hour"}],msg:"欢迎来到 App 首页"}},methods:{toPage:function(t){this.$router.push(t)}}},v,!1,function(t){i("J+9v")},"data-v-b14c9f00",null).exports,g=i("BO1k"),y=i.n(g),w={name:"AppIcon",data:function(){return{icon_list:[],icon_msg:"",icon_prefix:"fas"}},created:function(){var t=document.styleSheets,e=[],i=!0,a=!1,n=void 0;try{for(var s,o=y()(t);!(i=(s=o.next()).done);i=!0){var l=s.value,r=!0,c=!1,u=void 0;try{for(var d,m=y()(l.cssRules);!(r=(d=m.next()).done);r=!0){var p=d.value;p.selectorText&&p.selectorText.startsWith(".fa-")&&p.selectorText.endsWith("::before")&&e.push(p.selectorText.slice(1,p.selectorText.indexOf("::")))}}catch(t){c=!0,u=t}finally{try{!r&&m.return&&m.return()}finally{if(c)throw u}}}}catch(t){a=!0,n=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw n}}this.icon_list=e,0===this.icon_list.length&&(this.icon_msg="似乎没找到css文件 (ノへ￣、)")},methods:{copyIconName:function(t){var e=this.icon_prefix+" "+t,i=document.createElement("input");i.setAttribute("display","none"),document.body.appendChild(i),i.setAttribute("value",e),i.select(),document.execCommand("copy")&&document.execCommand("copy"),document.body.removeChild(i),this.$notify({type:"success",title:"提示",message:"Icon已复制: "+e,offset:60})}}},b={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-row",{staticClass:"main-content"},[i("el-col",[i("div",{staticClass:"switch-icon-prefix"},[i("el-switch",{attrs:{"active-color":"#409EFF","inactive-color":"#67C23A","active-value":"fas","inactive-value":"fab"},model:{value:t.icon_prefix,callback:function(e){t.icon_prefix=e},expression:"icon_prefix"}})],1),t._v(" "),t.icon_list.length>0?i("div",{staticClass:"icons-list"},t._l(t.icon_list,function(e){return i("div",{key:e,staticClass:"icon-content",on:{click:function(i){return t.copyIconName(e)}}},[i("i",{class:t.icon_prefix+" "+e}),t._v(" "),i("span",[t._v(t._s(e))])])}),0):i("div",{staticClass:"icons-msg"},[t._v("\n            "+t._s(t.icon_msg)+"\n        ")])])],1)},staticRenderFns:[]};var C=i("VU/8")(w,b,!1,function(t){i("qFEt")},"data-v-053e9010",null).exports,x={name:"AppNovels",filters:{chapter:function(t){return 0===t?"":"第"+t+"页"},interceptStr:function(t){return(t||"").replaceAll("\r|\n","").trim().slice(0,25)},getNovelName:function(t){var e=new RegExp("《(?<name>[^《》]*)》.*","i").exec(t);return e?e.groups.name:t},simpleVoiceName:function(t){return"Microsoft Huihui - Chinese (Simplified, PRC)"===t?"Huihui":"Microsoft Kangkang - Chinese (Simplified, PRC)"===t?"Kangkang":"Microsoft Yaoyao - Chinese (Simplified, PRC)"===t?"Yaoyao":t}},data:function(){return{novel_msg:"正在读取文件...",novel_name:"",novel_chapter:[],novel_content:[],novel_page:0,font_size:"18.7px",font_size_options:[{value:"56px",label:"初号"},{value:"48px",label:"小初"},{value:"34.7px",label:"一号"},{value:"32px",label:"小一"},{value:"29.3px",label:"二号"},{value:"24px",label:"小二"},{value:"21.3px",label:"三号"},{value:"20px",label:"小三"},{value:"18.7px",label:"四号"},{value:"16px",label:"小四"},{value:"14px",label:"五号"},{value:"12px",label:"小五"},{value:"10px",label:"六号"},{value:"8.7px",label:"小六"},{value:"7.3px",label:"七号"},{value:"6.7px",label:"八号"}],font_family:"Microsoft YaHei",bg_color:"#ffffff",predefine_bg_colors:["#ffffff","#f9f6ed","#f5edd4","#e6f3e9","#e7f4f5","#f5e8e7","#e3e5e3","#181a1b"],color:"#262626",predefine_colors:["#262626","#666"],height:520,custom_api:"https://api.github.com/repos/onedx1943/Files/contents",filterText:"",defaultProps:{children:"children",label:"label",isLeaf:"isLeaf"},node_had:void 0,resolve_had:void 0,loading:!1,dialogVisible:!1,showBookshelf:!0,novelList:[],dialogAddNovels:!1,synthesis:null,voiceList:[],voiceType:null,voiceRate:1,voicePitch:1,voicePlay:!1,readNum:-1}},watch:{filterText:function(t){this.$refs.tree.filter(t.toLowerCase())},readList:function(t){this.readNum=-1},voiceType:function(t){this.debouncedSetSpeak()},voiceRate:function(t){this.debouncedSetSpeak()},voicePitch:function(t){this.debouncedSetSpeak()}},computed:{readList:function(){var t=[];return this.novel_page>0&&(t=this.novel_content[this.novel_page-1].split(/[\u3000| ]/).filter(function(t){return""!==t})).unshift(this.novel_chapter[this.novel_page-1]),t}},created:function(){window.addEventListener("beforeunload",this.speakCancel),this.debouncedSetSpeak=_.debounce(this.setSpeak,500)},mounted:function(){var t=this;t.synthesis=window.speechSynthesis,t.getVoicesList(),void 0!==window.speechSynthesis.onvoiceschanged&&(window.speechSynthesis.onvoiceschanged=t.getVoicesList),t.$localforage.getItem("novel_list").then(function(e){null===e?t.novelList=[]:(t.novelList=e,t.novelList.sort(function(t,e){return e.timestamp-t.timestamp}))}).catch(function(t){console.log(t)})},beforeDestroy:function(){this.speakCancel()},destroy:function(){window.removeEventListener("beforeunload",this.speakCancel)},methods:{loadNode:function(t,e){if(0!==t.level&&t.data.isLeaf)return e([]);var i=this,a="";0===t.level?(a=i.custom_api,i.node_had=t,i.resolve_had=e):a=t.data.url,i.$http.get(a,{headers:{Authorization:i.$token1+i.$token2+i.$token3}}).then(function(t){i.limitNotification(t.headers);for(var a=[],n=0;n<t.data.length;n++)t.data[n].name.endsWith(".txt")?a.push({label:t.data[n].name+" ("+(t.data[n].size/1024/1024).toFixed(2)+"M)",isLeaf:!0,url:t.data[n].download_url,id:t.data[n].sha,name:t.data[n].name}):"dir"===t.data[n].type&&a.push({label:t.data[n].name,isLeaf:!1,url:t.data[n].url,id:t.data[n].sha,name:t.data[n].name});return e(a)}).catch(function(t){i.$notify({type:"error",title:"错误",message:"API访问失败，请检查",offset:60}),console.log(t)})},clearTree:function(){this.node_had&&(this.node_had.childNodes=[],this.loadNode(this.node_had,this.resolve_had))},filterNode:function(t,e){return!t||-1!==e.label.toLowerCase().indexOf(t)},limitNotification:function(t){var e=t["x-ratelimit-limit"],i=t["x-ratelimit-remaining"];parseInt(i)/parseInt(e)<.4&&this.$notify({type:"warning",title:"警告",message:"请求速率限制: "+i+"/"+e+"每小时",offset:60})},handleCurrentChange:function(t){this.saveToSession()},getChapterFromSession:function(){if(""!==this.novel_name){var t=this;t.$localforage.getItem("novel_"+this.novel_name).then(function(e){e&&(t.novel_page=e.page)}).catch(function(t){console.log(t)})}},pre_page:function(){if(this.novel_page>1){this.readNum>-1&&this.setSpeak(),this.novel_page-=1,this.saveToSession();var t=this;t.$nextTick(function(){t.readNum=-1})}},next_page:function(){if(this.novel_page<this.novel_chapter.length){this.readNum>-1&&this.setSpeak(),this.novel_page+=1,this.saveToSession();var t=this;t.$nextTick(function(){t.readNum=-1})}},saveToSession:function(){var t=this;""!==this.novel_name&&(document.querySelector(".novel-content").scrollTop=0,t.$localforage.getItem("novel_"+t.novel_name).then(function(e){e&&(e.page=t.novel_page,t.$localforage.setItem("novel_"+t.novel_name,e).then(function(){t.$parent.refreshUsage()}))}).catch(function(t){console.log(t)}))},loadCustomApi:function(){var t=new RegExp(this.$apiReg,"i");this.novel_name="",this.novel_chapter=[],this.novel_content=[],this.novel_page=0,t.test(this.custom_api)?this.clearTree():(this.novel_msg="别瞎填链接~",this.novel_page=1,this.novel_chapter=["下面是提示信息："],this.novel_content=["链接格式：https://api.github.com/repos/用户名/仓库名/contents（仓库内具体路径可以接着加 /xxx/xxx）"])},selectFile:function(t){t.preventDefault(),t.stopPropagation(),document.querySelector("#local_file").click()},uploadLocalFile:function(t){if(this.loading)return document.querySelector("#local_file").value="",this.$notify({type:"info",title:"提示",message:"请等待当前文件加载完成~",offset:60});var e=[];try{e=t.target.files}catch(t){return}if(0!==e.length){var i=e[0],a=this,n=new FileReader;n.onload=function(){var t=this.result;a.$localforage.getItem("novel_list").then(function(t){return null===t&&(t=[]),t.findIndex(function(t){return t.name===i.name})<0&&t.push({name:i.name,url:"",img:"data:image/jpeg;base64,",timestamp:(new Date).getTime()}),a.novelList=t,a.novelList.sort(function(t,e){return e.timestamp-t.timestamp}),a.$localforage.setItem("novel_list",t)}).then(function(){return a.$parent.refreshUsage(),a.$localforage.setItem("novel_"+i.name,{content:t,page:1})}).then(function(){a.$parent.refreshUsage(),a.dialogAddNovels=!1,document.querySelector("#local_file").value=""}).catch(function(t){console.log(t),document.querySelector("#local_file").value=""})},n.readAsText(i)}},addNovelsConfirm:function(){var t=this,e=t.$refs.tree.getCheckedNodes();t.$localforage.getItem("novel_list").then(function(i){null===i&&(i=[]);var a=function(t){t.isLeaf&&(i.findIndex(function(e){return e.name===t.name})<0&&i.push({name:t.name,url:t.url,img:"data:image/jpeg;base64,",timestamp:(new Date).getTime()}))},n=!0,s=!1,o=void 0;try{for(var l,r=y()(e);!(n=(l=r.next()).done);n=!0){a(l.value)}}catch(t){s=!0,o=t}finally{try{!n&&r.return&&r.return()}finally{if(s)throw o}}return t.novelList=i,t.novelList.sort(function(t,e){return e.timestamp-t.timestamp}),t.$localforage.setItem("novel_list",i)}).then(function(){t.$parent.refreshUsage(),t.dialogAddNovels=!1}).catch(function(t){console.log(t)})},openNovel:function(t){var e=this;e.loading=!0,e.novel_name=t.name,e.novel_chapter=["提示："],e.novel_content=["正在读取..."],e.novel_page=1,e.showBookshelf=!1,e.readNum=-1,e.updateTimestamp(t.name);var i="novel_"+t.name;e.$localforage.getItem(i).then(function(i){null===i?e.downloadNovel(t):e.loadNovelContent(i.content,i.page)}).catch(function(t){console.log(t)})},downloadNovel:function(t){var e=this;e.$http.get(t.url).then(function(i){var a={content:i.data,page:1};e.$localforage.setItem("novel_"+t.name,a).then(function(){e.$parent.refreshUsage(),e.loadNovelContent(i.data,1)})}).then(function(){e.getNovelCover(t)}).catch(function(t){console.log(t),e.novel_content=["取文件失败喽！"],e.$notify({type:"error",title:"错误",message:"获取文件失败，请检查",offset:60}),e.loading=!1})},loadNovelContent:function(t,e){if(""===t)return this.novel_content=["该文件内容为空，还是看看别的吧"],void(this.loading=!1);var i=/\n\s*[第]{1,2}[0-9零○一二两三四五六七八九十百千廿卅卌壹贰叁肆伍陆柒捌玖拾佰仟万１２３４５６７８９０]{1,5}[章节節堂讲回集部分品]{1,2}.*/g,a=t.match(i);if(a)a.unshift(this.novel_name);else if(a=[this.novel_name],t.length>1048576)return this.novel_content=["没找到章节名，而且内容还挺大，是不是文件编码有问题"],void(this.loading=!1);this.novel_chapter=a,this.novel_content=t.split(i),this.novel_page=e,this.loading=!1},deleteCacheNovel:function(t){var e=this;e.$localforage.getItem("novel_list").then(function(i){i.splice(i.findIndex(function(e){return e.name===t}),1),e.$localforage.setItem("novel_list",i).then(function(t){e.$parent.refreshUsage(),e.novelList=i,e.novelList.sort(function(t,e){return e.timestamp-t.timestamp})}),e.$localforage.removeItem("novel_"+t).then(function(){e.$parent.refreshUsage()})}).catch(function(t){console.log(t)})},updateTimestamp:function(t){var e=this;e.$localforage.getItem("novel_list").then(function(i){var a=i.findIndex(function(e){return e.name===t});i[a].timestamp=(new Date).getTime(),e.$localforage.setItem("novel_list",i).then(function(){e.$parent.refreshUsage(),e.novelList=i,e.novelList.sort(function(t,e){return e.timestamp-t.timestamp})})}).catch(function(t){console.log(t)})},getNovelCover:function(t){var e=this,i=t.url.slice(0,t.url.length-3)+"jpg";e.getBase64ImageUrl(i,"jpg",function(i){e.$localforage.getItem("novel_list").then(function(a){var n=a.findIndex(function(e){return e.name===t.name});a[n].img=i,e.$localforage.setItem("novel_list",a).then(function(){e.$parent.refreshUsage(),e.novelList=a,e.novelList.sort(function(t,e){return e.timestamp-t.timestamp})})})})},getBase64ImageUrl:function(t,e,i){var a=new XMLHttpRequest;a.responseType="arraybuffer",a.open("GET",t,!0),a.onload=function(){var t=a.response,n=new File([t],"image."+e,{type:"image/"+e}),s=new FileReader;s.onload=function(t){i(t.target.result)},s.readAsDataURL(n)},a.send(null)},backToBookshelf:function(){this.showBookshelf=!0,this.speakCancel()},getVoicesList:function(){this.voiceList=this.synthesis.getVoices().filter(function(t){return t.lang.startsWith("zh-")&&t.localService}),this.voiceList.length>0&&(this.voiceType=this.voiceList[0])},speakStart:function(t){var e=this;if(this.synthesis.speaking)console.error("speechSynthesis.speaking");else if(""!==t){var i=new SpeechSynthesisUtterance(t);i.onend=function(t){e.voicePlay&&(e.readNum++,e.readNum<0&&(e.readNum=0),e.readNum===e.readList.length&&e.next_page(),e.$nextTick(function(){e.listenBook()}))},i.onerror=function(t){console.error("SpeechSynthesisUtterance.onerror")},i.voice=this.voiceType,i.pitch=this.voicePitch,i.rate=this.voiceRate,this.synthesis.speak(i)}},speakCancel:function(){this.voicePlay=!1,this.synthesis&&this.synthesis.cancel()},listenBook:function(){this.synthesis.paused&&this.synthesis.speaking?(this.synthesis.resume(),this.voicePlay=!0):this.synthesis.speaking?(this.synthesis.pause(),this.voicePlay=!1):(this.readNum<0&&(this.readNum=0),this.speakStart(this.readList[this.readNum]),this.voicePlay=!0)},jumpChapter:function(t){this.$refs["catalog-popover"].doClose(),this.novel_page=t+1,this.saveToSession()},showCurrentChapter:function(){document.querySelector(".reader-catalog").scrollTop=document.querySelector(".chapter-item.selected").offsetTop},setSpeak:function(){this.voicePlay&&this.readNum--,this.synthesis&&this.synthesis.cancel()}}},k={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"main-content"},[i("el-row",{directives:[{name:"show",rawName:"v-show",value:t.showBookshelf,expression:"showBookshelf"}]},[i("el-col",{attrs:{span:24}},[i("div",{staticClass:"novel-bookshelf"},[i("div",{staticClass:"item-novel"},[i("div",{staticClass:"novel-add",on:{click:function(e){t.dialogAddNovels=!0}}},[i("i",{staticClass:"el-icon-plus"})]),t._v(" "),i("div",{staticClass:"novel-name"})]),t._v(" "),t._l(t.novelList,function(e){return i("div",{key:e.name,staticClass:"item-novel"},[i("div",{staticClass:"item-novel-cover"},[i("el-image",{staticClass:"novel-cover-img",attrs:{fit:"fill",src:e.img}},[i("div",{staticClass:"novel-cover-txt",attrs:{slot:"error"},slot:"error"},[t._v("\n                                "+t._s(t._f("getNovelName")(e.name))+"\n                            ")])]),t._v(" "),i("span",{staticClass:"novel-cover-shadow",on:{click:function(i){return t.openNovel(e)}}}),t._v(" "),i("el-popconfirm",{attrs:{"confirm-button-text":"是的","cancel-button-text":"不了",icon:"el-icon-info","icon-color":"red",title:"确定要删除？"},on:{confirm:function(i){return t.deleteCacheNovel(e.name)}}},[i("el-button",{staticClass:"item-novel-delete",attrs:{slot:"reference",plain:"",type:"danger",size:"small",icon:"el-icon-delete"},slot:"reference"})],1)],1),t._v(" "),i("div",{staticClass:"novel-name",attrs:{title:e.name}},[t._v(t._s(e.name))])])})],2)])],1),t._v(" "),i("el-row",{directives:[{name:"show",rawName:"v-show",value:!t.showBookshelf,expression:"!showBookshelf"}]},[i("el-col",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"element-loading-text":"拼命加载中","element-loading-background":"rgba(255, 255, 255, 0.8)"}},[i("div",{staticClass:"novel-read-operate"},[i("div",[i("el-button",{attrs:{type:"primary",plain:"",size:"small",icon:"el-icon-back"},on:{click:t.backToBookshelf}},[t._v("返回书架")]),t._v(" "),t.novel_page>0&&t.novel_page<=t.novel_chapter.length?i("el-button",{attrs:{type:"success",plain:"",size:"small"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("阅读模式\n                    ")]):t._e(),t._v(" "),i("el-button",{attrs:{type:"danger",plain:"",size:"small",icon:t.voicePlay?"el-icon-video-pause":"el-icon-video-play"},on:{click:t.listenBook}}),t._v(" "),i("el-popover",{attrs:{placement:"right-start",width:"340",trigger:"click"}},[i("el-row",[i("el-col",[i("el-form",{attrs:{"label-position":"right","label-width":"80px"},nativeOn:{submit:function(t){t.preventDefault()}}},[i("el-form-item",{attrs:{label:"人声"}},[i("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.voiceType,callback:function(e){t.voiceType=e},expression:"voiceType"}},t._l(t.voiceList,function(e){return i("el-option",{key:e.name,attrs:{label:t._f("simpleVoiceName")(e.name),value:e}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:"语速"}},[i("el-input-number",{attrs:{size:"small",precision:1,step:.1,min:.1,max:10},model:{value:t.voiceRate,callback:function(e){t.voiceRate=e},expression:"voiceRate"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"音高"}},[i("el-input-number",{attrs:{size:"small",precision:1,step:.1,min:0,max:2},model:{value:t.voicePitch,callback:function(e){t.voicePitch=e},expression:"voicePitch"}})],1)],1)],1)],1),t._v(" "),i("el-button",{staticClass:"popover-btn",attrs:{slot:"reference",type:"danger",plain:"",size:"small",icon:"el-icon-headset"},slot:"reference"},[t._v("\n                            听书设置\n                        ")])],1)],1),t._v(" "),i("div",{staticClass:"novel-content-setting"},[i("el-popover",{ref:"catalog-popover",attrs:{"popper-class":"reader-catalog mini-scroll",placement:"left-end",width:"520",trigger:"click"},on:{"after-enter":t.showCurrentChapter}},[i("el-row",[i("el-col",t._l(t.novel_chapter,function(e,a){return i("div",{key:e,staticClass:"chapter-item",class:t.novel_page-1===a?"selected":"",on:{click:function(e){return t.jumpChapter(a)}}},[t._v("\n                                    "+t._s(a+1)+". "+t._s(e)+"\n                                ")])}),0)],1),t._v(" "),i("el-button",{staticClass:"popover-btn",attrs:{slot:"reference",type:"primary",plain:"",size:"small",icon:"el-icon-tickets"},slot:"reference"},[t._v("\n                            目录\n                        ")])],1),t._v(" "),i("el-popover",{attrs:{placement:"left-start",width:"400",trigger:"click"}},[i("div",{staticClass:"novel-setting"},[i("div",[t._v("字体大小：  \n                                "),i("el-select",{attrs:{placeholder:"请选择",size:"small"},model:{value:t.font_size,callback:function(e){t.font_size=e},expression:"font_size"}},t._l(t.font_size_options,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),i("div",[t._v("字体类型：  \n                                "),i("div",[i("el-radio-group",{attrs:{size:"small"},model:{value:t.font_family,callback:function(e){t.font_family=e},expression:"font_family"}},[i("el-radio-button",{attrs:{label:"SimSun"}},[t._v("宋体")]),t._v(" "),i("el-radio-button",{attrs:{label:"Microsoft YaHei"}},[t._v("雅黑")]),t._v(" "),i("el-radio-button",{attrs:{label:"KaiTi"}},[t._v("楷体")]),t._v(" "),i("el-radio-button",{attrs:{label:"STXingkai"}},[t._v("行楷")])],1)],1)]),t._v(" "),i("div",[t._v("背景颜色：  \n                                "),i("el-color-picker",{attrs:{"show-alpha":"",predefine:t.predefine_bg_colors,size:"small"},model:{value:t.bg_color,callback:function(e){t.bg_color=e},expression:"bg_color"}})],1),t._v(" "),i("div",[t._v("文字颜色：  \n                                "),i("el-color-picker",{attrs:{"show-alpha":"",predefine:t.predefine_colors,size:"small"},model:{value:t.color,callback:function(e){t.color=e},expression:"color"}})],1),t._v(" "),i("div",[t._v("内容高度：  \n                                "),i("el-input-number",{attrs:{controls:!1,size:"small",min:0,max:1200},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}})],1)]),t._v(" "),i("el-button",{attrs:{slot:"reference",type:"primary",icon:"el-icon-s-tools",circle:""},slot:"reference"})],1)],1)]),t._v(" "),i("div",{staticClass:"novel-title"},[i("div",{staticClass:"novel-title-book"},[t._v(t._s(t.novel_name))]),t._v(" "),i("div",{staticClass:"novel-title-chapter"},[t._v(t._s(t.novel_chapter[t.novel_page-1]))])]),t._v(" "),i("div",{staticClass:"novel-container"},[i("div",{staticClass:"novel-content mini-scroll",style:{"background-color":t.bg_color,color:t.color,"max-height":t.height+"px"}},[i("pre",{style:{"font-size":t.font_size,"font-family":t.font_family,"line-height":"36px"}},[t._v("                        "),i("span",[t._v(t._s(t.novel_content[t.novel_page-1]))]),t._v("\n                    ")]),t._v(" "),t.novel_chapter.length>1?i("div",{staticClass:"turn_page"},[i("el-button",{attrs:{plain:"",icon:"el-icon-arrow-left"},on:{click:t.pre_page}},[t._v(t._s(t._f("interceptStr")(t.novel_chapter[t.novel_page-2])))]),t._v(" "),i("div",[t._v(t._s(t._f("interceptStr")(t.novel_chapter[t.novel_page-1])))]),t._v(" "),i("el-button",{attrs:{plain:""},on:{click:t.next_page}},[t._v(t._s(t._f("interceptStr")(t.novel_chapter[t.novel_page]))),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1):t._e()]),t._v(" "),t.novel_chapter.length>1?i("div",{staticClass:"turn_page"},[i("el-button",{attrs:{plain:""},on:{click:t.pre_page}},[t._v("上一章")]),t._v(" "),i("div",[t._v(t._s(t.novel_page))]),t._v(" "),i("el-button",{attrs:{plain:""},on:{click:t.next_page}},[t._v("下一章")])],1):t._e()])])],1),t._v(" "),i("el-dialog",{attrs:{title:"添加小说",visible:t.dialogAddNovels,"append-to-body":!0,"custom-class":"dialog-add-novels"},on:{"update:visible":function(e){t.dialogAddNovels=e}}},[i("div",[i("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"local_file",accept:".txt"},on:{change:function(e){return t.uploadLocalFile(e)}}}),t._v(" "),i("el-button",{staticClass:"load-local-btn",attrs:{type:"primary",plain:"",size:"small"},on:{click:function(e){return t.selectFile(e)}}},[t._v("打开本地文件\n            ")]),t._v(" "),i("div",{staticClass:"novel-custom"},[i("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.custom_api,callback:function(e){t.custom_api=e},expression:"custom_api"}},[i("template",{slot:"prepend"},[t._v("自定义github仓库地址")]),t._v(" "),i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.loadCustomApi},slot:"append"})],2)],1),t._v(" "),i("div",{staticClass:"novel-list"},[i("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}),t._v(" "),i("el-tree",{ref:"tree",staticClass:"filter-tree novel-list-content",attrs:{lazy:"","show-checkbox":"","node-key":"id",load:t.loadNode,props:t.defaultProps,"filter-node-method":t.filterNode}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogAddNovels=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.addNovelsConfirm}},[t._v("确 定")])],1)]),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogVisible,fullscreen:!0,modal:!1,"custom-class":"novel-dialog"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"novel-content mini-scroll",style:{"background-color":t.bg_color,color:t.color,"max-height":"calc(100vh - 80px)"}},[i("pre",{style:{"font-size":t.font_size,"font-family":t.font_family,"line-height":"36px"}},[t._v("                "),i("span",[t._v(t._s(t.novel_content[t.novel_page-1]))]),t._v("\n            ")]),t._v(" "),t.novel_chapter.length>1?i("div",{staticClass:"turn_page"},[i("el-button",{attrs:{plain:"",icon:"el-icon-arrow-left"},on:{click:t.pre_page}},[t._v(t._s(t._f("interceptStr")(t.novel_chapter[t.novel_page-2])))]),t._v(" "),i("div",[t._v(t._s(t._f("interceptStr")(t.novel_chapter[t.novel_page-1])))]),t._v(" "),i("el-button",{attrs:{plain:""},on:{click:t.next_page}},[t._v(t._s(t._f("interceptStr")(t.novel_chapter[t.novel_page]))),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1):t._e()]),t._v(" "),t.novel_chapter.length>1?i("div",{staticClass:"turn_page"},[i("el-button",{attrs:{plain:""},on:{click:t.pre_page}},[t._v("上一章")]),t._v(" "),i("div",[t._v(t._s(t.novel_page))]),t._v(" "),i("el-button",{attrs:{plain:""},on:{click:t.next_page}},[t._v("下一章")])],1):t._e()])],1)},staticRenderFns:[]};var $=i("VU/8")(x,k,!1,function(t){i("3+dM")},"data-v-11374ba0",null).exports,L=i("TISC"),S={name:"AppMusic",filters:{formatSeconds:function(t){var e=[],i=Math.floor(t/3600);0!==i&&e.push(i>9?i:"0"+i);var a=Math.floor(t%3600/60);e.push(a>9?a:"0"+a);var n=t%60;return e.push(n>9?n:"0"+n),e.join(":")},showPlayListName:function(t){return t.slice(4)},showDownloadName:function(t){return t.slice(9)},formatSize:function(t){return(t/1024/1024).toFixed(2)+"M"}},data:function(){var t=function(t,e,i){var a=new RegExp(/^[\u4e00-\u9fa5\w-]+$/,"i");""===e?i():a.test(e)?i():i(new Error("输的啥啊，不给创建"))};return{music_list:[],music_msg:"正在读取文件...",tips_msg:"",audioContext:null,source:null,animationId:null,status:0,forceStop:!1,allCapsReachBottom:!1,play_model:0,play_num:0,play_name:"",timer:null,start_time:0,duration_time:0,current_time:0,percentage:0,volume:5,volume_actual:5,muted:!1,gainNode:null,imgUrl:"data:image/jpeg;base64,",jsMediaTags:L,musicTitle:"",musicAlbum:"",musicArtist:"",lyricsList:[],lyricsContent:[],musicLyricsMsg:"",activeNames:["1","2"],play_list:[],playlist_own:[],playlist_collection:[],playlist_content:[],search_music:"",request_count:0,playlist_select_name:"",playlist_select_api:"",fullscreenLoading:!1,dialogCollectionVisible:!1,collectionForm:{name:"",username:"onedx1943",repo:"musicLowBitRate",path:""},collectionFormRules:{name:[{required:!0,message:"请输入歌单名称",trigger:"change"},{validator:t,trigger:"change"}],username:[{required:!0,message:"请输入用户名称",trigger:"change"},{validator:t,trigger:"change"}],repo:[{required:!0,message:"请输入仓库名称",trigger:"change"},{validator:t,trigger:"change"}],path:[]},download_music_list:[],downloading_list:[],playlist_img:"data:image/jpeg;base64,",error_img:"https://raw.githubusercontent.com/onedx1943/Picture/master/png/sticker42.png",show_lyrics_board:!1,lyrics_api:"https://api.github.com/repos/onedx1943/Lyrics/contents"}},watch:{},computed:{download_table:function(){var t=[],e=!0,i=!1,a=void 0;try{for(var n,s=y()(this.download_music_list);!(e=(n=s.next()).done);e=!0){var o=n.value;t.push({name:o})}}catch(t){i=!0,a=t}finally{try{!e&&s.return&&s.return()}finally{if(i)throw a}}return t},background_img:function(){return"background-image: url("+this.imgUrl+")"}},mounted:function(){var t=this;window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame,this.getMusicLyrics(this.lyrics_api),t.$localforage.getItem("volume").then(function(e){null!==e&&(t.volume=e)}),t.$localforage.keys().then(function(e){null===e&&(e=[]);var i=!0,a=!1,n=void 0;try{for(var s,o=y()(e);!(i=(s=o.next()).done);i=!0){var l=s.value;l.startsWith("download_")&&t.download_music_list.push(l)}}catch(t){a=!0,n=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw n}}return t.$localforage.getItem("playlist_own")}).then(function(e){if(null===e){var i=[{name:"own_我喜欢的音乐",address:""}];t.$localforage.setItem("playlist_own",i).then(function(){t.$parent.refreshUsage()}),t.playlist_own=i}else e.length>0&&(t.playlist_own=e);return t.$localforage.getItem("playlist_collection")}).then(function(e){if(null===e){var i=[{name:"clt_onedx的歌单",address:"https://api.github.com/repos/onedx1943/musicLowBitRate/contents"}];t.$localforage.setItem("playlist_collection",i).then(function(){t.$parent.refreshUsage()}),t.playlist_collection=i}else e.length>0&&(t.playlist_collection=e)}).catch(function(t){console.log(t)})},beforeDestroy:function(){this.stopMusic(!0),null!=this.audioContext&&(this.audioContext.close(),this.audioContext=null)},methods:{addPlaylistOwn:function(t){t.preventDefault(),t.stopPropagation();var e=this;e.$prompt("","新建歌单",{confirmButtonText:"确定",cancelButtonText:"取消",inputPlaceholder:"请输入新歌单标题",inputPattern:/^[\u4e00-\u9fa5\w-]+$/,inputErrorMessage:"求求你输入点正常的东西吧"}).then(function(t){var i=t.value;e.$localforage.getItem("playlist_own").then(function(t){null===t&&(t=[]);var a="own_"+i,n=!0,s=!1,o=void 0;try{for(var l,r=y()(t);!(n=(l=r.next()).done);n=!0){if(l.value.name===a)return e.$message({type:"info",message:"歌单已存在: "+i}),!1}}catch(t){s=!0,o=t}finally{try{!n&&r.return&&r.return()}finally{if(s)throw o}}return t.push({name:a,address:""}),e.playlist_own=t,e.$localforage.setItem("playlist_own",t)}).then(function(){e.$parent.refreshUsage()}).catch(function(t){console.log(t)})}).catch(function(t){console.log(t)})},addPlaylistCollection:function(t){t.preventDefault(),t.stopPropagation(),this.dialogCollectionVisible=!0},addPlaylistCollectionConfirm:function(){var t=this,e=this;this.$refs.collectionForm.validate(function(i){if(!i)return!1;var a=new RegExp(t.$apiReg,"i"),n="https://api.github.com/repos/"+e.collectionForm.username+"/"+e.collectionForm.repo+"/contents"+e.collectionForm.path;if(!a.test(n))return e.$notify.error({title:"错误",message:"歌单地址不对吧？"}),!1;e.$localforage.getItem("playlist_collection").then(function(t){null===t&&(t=[]);var i="clt_"+e.collectionForm.name,a=!0,s=!1,o=void 0;try{for(var l,r=y()(t);!(a=(l=r.next()).done);a=!0){if(l.value.name===i)return e.$message({type:"info",message:"歌单已存在: "+e.collectionForm.name}),!1}}catch(t){s=!0,o=t}finally{try{!a&&r.return&&r.return()}finally{if(s)throw o}}return t.push({name:i,address:n}),e.playlist_collection=t,e.addPlaylistCollectionCancel(),e.$localforage.setItem("playlist_collection",t)}).then(function(){e.$parent.refreshUsage()}).catch(function(t){console.log(t)})})},addPlaylistCollectionCancel:function(){this.dialogCollectionVisible=!1,this.$refs.collectionForm.resetFields()},showPlaylist:function(t,e,i){document.querySelector(".item-playlist.selected")&&document.querySelector(".item-playlist.selected").classList.remove("selected"),t.currentTarget.classList.add("selected");var a=this;a.search_music="",a.playlist_select_name=e,a.playlist_select_api=i,a.playlist_content=[],a.fullscreenLoading=!0,a.playlist_img="data:image/jpeg;base64,",a.$localforage.getItem(e).then(function(t){null===t?e.startsWith("clt_")?a.syncPlaylist(e,i):(a.$localforage.setItem(e,[]).then(function(){a.$parent.refreshUsage()}),a.fullscreenLoading=!1):(a.playlist_content=t,a.$localforage.keys().then(function(t){null===t&&(t=[]);var e=!0,i=!1,n=void 0;try{for(var s,o=y()(a.playlist_content);!(e=(s=o.next()).done);e=!0){var l=s.value;if(t.includes("img_"+l.name))return a.$localforage.getItem("img_"+l.name)}}catch(t){i=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(i)throw n}}}).then(function(t){t&&(a.playlist_img=t)}),a.$nextTick(function(){a.fullscreenLoading=!1}))}).catch(function(t){console.log(t),a.fullscreenLoading=!1})},syncPlaylist:function(t,e){this.fullscreenLoading=!0,this.playlist_content=[],this.getMusicList(e),this.updatePlaylist(t)},updatePlaylist:function(t){var e=this;this.request_count>0?setTimeout(function(){e.updatePlaylist(t)},100):e.$localforage.setItem(t,e.playlist_content).then(function(t){e.fullscreenLoading=!1,e.$parent.refreshUsage()})},getMusicList:function(t){var e=this;e.request_count++,e.$http.get(t,{headers:{Authorization:e.$token1+e.$token2+e.$token3}}).then(function(i){e.limitNotification(i.headers);for(var a=0;a<i.data.length;a++)if(i.data[a].name.endsWith(".mp3")||i.data[a].name.endsWith(".flac"))e.playlist_content.push(i.data[a]);else if("dir"===i.data[a].type){var n=t+"/"+i.data[a].name;e.getMusicList(n)}e.request_count--}).catch(function(t){console.log(t),e.music_msg="网络或者链接有问题啊，读取失败了！",e.request_count--})},deletePlaylist:function(t){var e=this,i="";i=t.startsWith("own_")?"playlist_own":"playlist_collection",e.$localforage.getItem(i).then(function(a){a.splice(a.findIndex(function(e){return e.name===t}),1),e.$localforage.setItem(i,a).then(function(i){e.playlist_select_name="",e.playlist_select_api="",e.playlist_content=[],t.startsWith("own_")?e.playlist_own=a:e.playlist_collection=a,e.$parent.refreshUsage()}),e.$localforage.removeItem(t).then(function(){e.$parent.refreshUsage()})}).catch(function(t){console.log(t)})},startPlaylist:function(){var t=this;this.stopMusic(!0),this.play_num=0,this.music_list=this.playlist_content,this.$nextTick(function(){t.playMusic()})},addToPlay:function(t){var e=this;this.stopMusic(!0);var i=this.music_list.findIndex(function(e){return e.name===t.name});i>-1?this.play_num=i:(this.music_list.push(t),this.play_num=this.music_list.length-1),this.$nextTick(function(){e.playMusic()})},addToPlaylist:function(t,e,i){var a=this;a.$refs[i].doClose(),a.$localforage.getItem(t).then(function(i){null===i&&(i=[]),i.findIndex(function(t){return t.name===e.name})>-1?a.$message({type:"info",message:"歌单中已经有这首歌啦: "+e.name}):(i.push(e),a.$localforage.setItem(t,i).then(function(t){a.$parent.refreshUsage(),a.$message({type:"success",message:"收藏成功"})}))}).catch(function(t){console.log(t)})},addDownloadToPlay:function(t){var e=this;this.stopMusic(!0),e.$localforage.getItem(t.name).then(function(t){if(t){var i=e.music_list.findIndex(function(e){return e.name===t.name});i>-1?e.play_num=i:(t.array_buffer=void 0,e.music_list.push(t),e.play_num=e.music_list.length-1),e.$nextTick(function(){e.playMusic()})}else e.tips_msg="本地文件读取失败"}).catch(function(t){console.log(t)})},addDownloadToPlaylist:function(t,e,i){var a=this;a.$refs[i].doClose(),a.$localforage.getItem(e.name).then(function(i){i?a.$localforage.getItem(t).then(function(n){null===n&&(n=[]),n.findIndex(function(t){return t.name===i.name})>-1?a.$message({type:"info",message:"歌单中已经有这首歌啦: "+e.name}):(i.array_buffer=void 0,n.push(i),a.$localforage.setItem(t,n).then(function(t){a.$parent.refreshUsage(),a.$message({type:"success",message:"收藏成功"})}))}):a.tips_msg="本地文件读取失败"}).catch(function(t){console.log(t)})},removeFromPlaylist:function(t,e){var i=this;i.$localforage.getItem(t).then(function(a){a.splice(a.findIndex(function(t){return t.name===e.name}),1),i.$localforage.setItem(t,a).then(function(t){i.playlist_content=a,i.$parent.refreshUsage()})}).catch(function(t){console.log(t)})},hasDownload:function(t){return this.download_music_list.includes("download_"+t)},downloadMusic:function(t,e){var i=this,a="download_"+e.name;if(t.currentTarget.classList.remove("el-icon-download"),t.currentTarget.classList.add("el-icon-loading"),this.downloading_list.includes(a))return i.$message({type:"info",message:e.name+"正在下载了"});i.downloading_list.push(a),i.$http({method:"get",url:e.download_url,responseType:"arraybuffer"}).then(function(t){e.array_buffer=t.data,i.$localforage.setItem(a,e).then(function(t){i.download_music_list.includes(a)||i.download_music_list.push(a),i.downloading_list.splice(i.downloading_list.findIndex(function(t){return t===a}),1),i.$parent.refreshUsage()})}).catch(function(e){console.log(e),i.$notify({type:"error",title:"错误",message:"下载失败咯",offset:60}),i.downloading_list.splice(i.downloading_list.findIndex(function(t){return t===a}),1),t.currentTarget.classList.remove("el-icon-loading"),t.currentTarget.classList.add("el-icon-download")})},showDownloadList:function(t,e,i){document.querySelector(".item-playlist.selected")&&document.querySelector(".item-playlist.selected").classList.remove("selected"),t.currentTarget.classList.add("selected");var a=this;a.search_music="",a.playlist_select_name=e,a.playlist_select_api=i,a.fullscreenLoading=!0,a.$localforage.keys().then(function(t){null===t&&(t=[]);var e=[],i=!0,n=!1,s=void 0;try{for(var o,l=y()(t);!(i=(o=l.next()).done);i=!0){var r=o.value;r.startsWith("download_")&&e.push(r)}}catch(t){n=!0,s=t}finally{try{!i&&l.return&&l.return()}finally{if(n)throw s}}a.download_music_list=e,a.$nextTick(function(){a.fullscreenLoading=!1})}).catch(function(t){console.log(t),a.fullscreenLoading=!1})},removeDownload:function(t){var e=this;e.$localforage.removeItem(t).then(function(){return e.$parent.refreshUsage(),e.$localforage.keys()}).then(function(t){null===t&&(t=[]);var i=[],a=!0,n=!1,s=void 0;try{for(var o,l=y()(t);!(a=(o=l.next()).done);a=!0){var r=o.value;r.startsWith("download_")&&i.push(r)}}catch(t){n=!0,s=t}finally{try{!a&&l.return&&l.return()}finally{if(n)throw s}}e.download_music_list=i}).catch(function(t){console.log(t)})},deleteCacheFile:function(t){var e=this;e.$localforage.keys().then(function(i){null===i&&(i=[]);var a=!0,n=!1,s=void 0;try{for(var o,l=y()(i);!(a=(o=l.next()).done);a=!0){var r=o.value;r.startsWith(t)&&e.$localforage.removeItem(r).then(function(){e.$parent.refreshUsage()})}}catch(t){n=!0,s=t}finally{try{!a&&l.return&&l.return()}finally{if(n)throw s}}"download_"===t&&(e.download_music_list=[])}).catch(function(t){console.log(t)})},getMusicContent:function(t,e){var i=this,a=e.name;i.imgUrl="data:image/jpeg;base64,",i.musicTitle="",i.musicAlbum="",i.musicArtist="",i.musicLyricsMsg="",i.lyricsContent=[],document.querySelector(".music-list .active-music")&&document.querySelector(".music-list .active-music").classList.remove("active-music"),t.currentTarget.classList.add("active-music");var n=parseInt(t.currentTarget.getAttribute("index"));i.play_name=a,this.stopMusic(!1),i.$localforage.getItem("download_"+a).then(function(t){null===t?(i.tips_msg="开始远程读取文件",i.$http({method:"get",url:e.download_url,responseType:"arraybuffer",onDownloadProgress:function(t){i.tips_msg="下载中... "+(t.loaded/t.total*100).toFixed()+"%"}}).then(function(t){var s="download_"+a;e.array_buffer=t.data,i.$localforage.setItem(s,e).then(function(e){i.$parent.refreshUsage(),i.download_music_list.includes(s)||i.download_music_list.push(s),i.loadMusicContent(t.data,n,a)})}).catch(function(t){console.log(t),i.tips_msg="远程文件读取失败"})):i.loadMusicContent(t.array_buffer,n,a)}).catch(function(t){console.log(t)})},limitNotification:function(t){var e=t["x-ratelimit-limit"],i=t["x-ratelimit-remaining"];parseInt(i)/parseInt(e)<.4&&this.$notify({type:"warning",title:"警告",message:"请求速率限制: "+i+"/"+e+"每小时",offset:60})},loadMusicContent:function(t,e,i){var a=this;if(null==a.audioContext)try{a.audioContext=new AudioContext}catch(t){return console.log(t),void(a.tips_msg="浏览器不支持AudioContext:(")}else a.audioContext.close(),a.audioContext=null,a.audioContext=new AudioContext;var n=a.audioContext;a.tips_msg="正在解码...",a.getMusicInfo(t,i),n.decodeAudioData(t,function(t){a.play_num=e,a._visualize(n,t)},function(t){console.log("文件解码失败:(")})},_visualize:function(t,e){var i=t.createBufferSource(),a=t.createAnalyser(),n=t.createGain(),s=this;n.gain.value=0,s.duration_time=Math.round(e.duration),s.current_time=0,clearInterval(s.timer),s.start_time=t.currentTime,s.timer=setInterval(function(){var e=t.currentTime-s.start_time;s.setActiveLyrics(e),s.current_time=Math.floor(e),s.percentage=s.current_time/s.duration_time*100},100),i.connect(n),i.connect(a),n.connect(t.destination),i.buffer=e,n.gain.linearRampToValueAtTime(s.volume/100,t.currentTime+1),s.gainNode=n,i.start||(i.start=i.noteOn,i.stop=i.noteOff),s.tips_msg=s.play_name,i.start(0),document.querySelector(".album-picture").classList.add("play"),s.status=1,s.source=i,i.onended=function(){s._audioEnd()}},_audioEnd:function(){this.status=0,this.forceStop?this.forceStop=!1:0===this.play_model?this.nextMusic():1===this.play_model?this.playMusic():2===this.play_model&&(this.play_num=Math.floor(Math.random()*this.music_list.length),this.playMusic())},preMusic:function(){2===this.play_model?this.play_num=Math.floor(Math.random()*this.music_list.length):this.play_num-=1,-1===this.play_num&&(this.play_num=this.music_list.length-1),document.querySelector('div[index="'+this.play_num+'"]')&&document.querySelector('div[index="'+this.play_num+'"]').click()},playMusic:function(){0===this.status?document.querySelector('div[index="'+this.play_num+'"]')&&document.querySelector('div[index="'+this.play_num+'"]').click():1===this.status?(this.audioContext.suspend(),this.status=2,document.querySelector(".album-picture").classList.remove("play")):2===this.status&&(this.audioContext.resume(),this.status=1,document.querySelector(".album-picture").classList.add("play"))},nextMusic:function(){2===this.play_model?this.play_num=Math.floor(Math.random()*this.music_list.length):this.play_num+=1,this.play_num===this.music_list.length&&(this.play_num=0),document.querySelector('div[index="'+this.play_num+'"]')&&document.querySelector('div[index="'+this.play_num+'"]').click()},stopMusic:function(t){document.title="onedx1943",this.forceStop=t,clearInterval(this.timer),this.duration_time=0,this.current_time=0,this.tips_msg="",this.percentage=0,null!==this.animationId&&cancelAnimationFrame(this.animationId),null!==this.source&&this.source.stop(0),null!=this.audioContext&&(this.audioContext.close(),this.audioContext=null),this.status=0,this.imgUrl="data:image/jpeg;base64,",this.musicTitle="",this.musicAlbum="",this.musicArtist="",this.lyricsContent=[],this.musicLyricsMsg="",document.querySelector(".album-picture")&&document.querySelector(".album-picture").classList.remove("play")},switchModel:function(){this.play_model=(this.play_model+1)%3},mutedPage:function(){this.muted=!this.muted,this.muted?(this.volume_actual=this.volume,this.volume=0):this.volume=this.volume_actual,this.gainNode&&this.audioContext&&this.gainNode.gain.linearRampToValueAtTime(this.volume/100*!this.muted,this.audioContext.currentTime+1)},resizeVolume:function(t){this.$localforage.setItem("volume",t),this.volume=t,this.muted=0===this.volume,this.gainNode&&this.audioContext&&this.gainNode.gain.linearRampToValueAtTime(this.volume/100*!this.muted,this.audioContext.currentTime+1)},getMusicInfo:function(t,e){var i=this;i.jsMediaTags.read(new Blob([t]),{onSuccess:function(t){if(t.tags.title)i.musicTitle=t.tags.title,i.getLyricsContent(t.tags.title);else{var a=e.substring(0,e.lastIndexOf("."));i.musicTitle=a,i.getLyricsContent(a)}document.title=i.musicTitle,t.tags.album?i.musicAlbum="专辑："+t.tags.album:i.musicAlbum="专辑：未知",t.tags.artist?i.musicArtist="歌手："+t.tags.artist:i.musicArtist="歌手：未知";var n=t.tags.picture;if(n){var s=new FileReader;s.onload=function(t){i.imgUrl=t.target.result,i.$localforage.setItem("img_"+e,i.imgUrl).then(function(){i.$parent.refreshUsage()}),"data:image/jpeg;base64,"===i.playlist_img&&(i.playlist_img=i.imgUrl)},s.readAsDataURL(new Blob([new Uint8Array(n.data)],{type:n.format}))}else i.imgUrl="data:image/jpeg;base64,"},onError:function(t){console.log(t),i.imgUrl="data:image/jpeg;base64,"}})},getMusicLyrics:function(t){var e=this;e.$http.get(t,{headers:{Authorization:e.$token1+e.$token2+e.$token3}}).then(function(i){e.limitNotification(i.headers);for(var a=0;a<i.data.length;a++)if(i.data[a].name.endsWith(".lrc"))e.lyricsList.push(i.data[a]);else if("dir"===i.data[a].type){var n=t+"/"+i.data[a].name;e.getMusicLyrics(n)}}).catch(function(t){console.log(t)})},getLyricsContent:function(t){var e=this;e.$localforage.getItem("lyrics_"+t).then(function(i){if(null===i){var a=null,n=!0,s=!1,o=void 0;try{for(var l,r=y()(e.lyricsList);!(n=(l=r.next()).done);n=!0){var c=l.value;if(c.name.includes(t)){a=c.download_url;break}}}catch(t){s=!0,o=t}finally{try{!n&&r.return&&r.return()}finally{if(s)throw o}}a?e.$http.get(a).then(function(i){e.$localforage.setItem("lyrics_"+t,i.data).then(function(t){e.$parent.refreshUsage(),e.loadLyricsContent(i.data)})}).catch(function(t){console.log(t)}):e.musicLyricsMsg="暂无歌词"}else e.loadLyricsContent(i)}).catch(function(t){console.log(t)})},loadLyricsContent:function(t){var e=t.split(/[\r\n]/),i=!0,a=!1,n=void 0;try{for(var s,o=y()(e);!(i=(s=o.next()).done);i=!0){var l=s.value,r=l.substring(l.indexOf("[")+1,l.indexOf("]"));/\d+:\d+.\d+/.test(r)&&this.lyricsContent.push({time:(60*r.split(":")[0]+parseFloat(r.split(":")[1])).toFixed(3),content:l.substring(l.indexOf("]")+1,l.length)})}}catch(t){a=!0,n=t}finally{try{!i&&o.return&&o.return()}finally{if(a)throw n}}this.lyricsContent.unshift({time:0,content:""}),1===this.lyricsContent.length&&(this.musicLyricsMsg="暂无歌词")},setActiveLyrics:function(t){for(var e=0,i=this.lyricsContent.length;e<i;e++)if(e===i-1||this.lyricsContent[e].time<=t&&t<this.lyricsContent[e+1].time){var a=document.querySelector('.music-lyrics div[time="'+this.lyricsContent[e].time+'"]');if(!a.classList.contains("active")){var n=a.offsetTop-160;n>0&&document.querySelector(".music-lyrics").scrollTo({top:n,behavior:"smooth"}),document.querySelector(".music-lyrics div.active")&&document.querySelector(".music-lyrics div.active").classList.remove("active"),a.classList.add("active")}break}}}},T={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{lock:!0}}],staticClass:"main-content"},[i("el-row",{staticStyle:{position:"relative"}},[i("el-col",{attrs:{span:24}},[i("transition",{attrs:{name:"el-zoom-in-bottom"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.show_lyrics_board,expression:"show_lyrics_board"}],staticClass:"lyrics-board"},[i("div",{staticClass:"media-tags-container"},[i("div",{staticClass:"lyrics-btn-container"},[i("el-button",{staticClass:"lyrics-close-btn",attrs:{plain:""},on:{click:function(e){t.show_lyrics_board=!1}}},[i("i",{staticClass:"fas fa-angle-double-down"})])],1),t._v(" "),i("div",{staticClass:"album-picture-container"},[i("el-image",{staticClass:"album-picture",attrs:{fit:"fill",src:t.imgUrl}},[i("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[t._v("\n                                    加载中"),i("span",{staticClass:"dot"},[t._v("...")])]),t._v(" "),i("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[i("div")])])],1),t._v(" "),i("div",{staticClass:"music-info-container"},[i("div",{staticClass:"music-info-title"},[t._v(t._s(t.musicTitle))]),t._v(" "),i("div",{staticClass:"music-info-data"},[i("div",[t._v(t._s(t.musicAlbum))]),t._v(" "),i("div",[t._v(t._s(t.musicArtist))])]),t._v(" "),t.lyricsContent.length>0?i("div",{staticClass:"music-lyrics mini-scroll"},t._l(t.lyricsContent,function(e,a){return i("div",{key:a,attrs:{time:e.time}},[t._v("\n                                    "+t._s(e.content)+"\n                                ")])}),0):i("div",{staticClass:"music-lyrics"},[t._v(t._s(t.musicLyricsMsg))])])])])])],1)],1),t._v(" "),i("el-row",{staticClass:"music-playlist-content"},[i("el-col",{attrs:{span:6}},[i("el-row",[i("el-col",{staticClass:"playlist-container",attrs:{span:24}},[i("div",{staticClass:"download-playlist"},[i("div",{staticClass:"item-playlist",on:{click:function(e){return t.showDownloadList(e,"已下载的音乐","")}}},[i("i",{staticClass:"el-icon-place item-playlist-icon"}),t._v(" "),i("div",{staticClass:"item-playlist-name"},[t._v("已下载的音乐")])])]),t._v(" "),i("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[i("el-collapse-item",{attrs:{name:"1"}},[i("template",{slot:"title"},[t._v("\n                                创建的歌单\n                                "),i("i",{staticClass:"el-icon-circle-plus-outline add-playlist",on:{click:function(e){return t.addPlaylistOwn(e)}}})]),t._v(" "),t.playlist_own.length>0?i("div",t._l(t.playlist_own,function(e){return i("div",{key:e.name,staticClass:"item-playlist",attrs:{title:t._f("showPlayListName")(e.name)},on:{click:function(i){return t.showPlaylist(i,e.name,e.address)}}},[i("i",{staticClass:"el-icon-milk-tea item-playlist-icon"}),t._v(" "),i("div",{staticClass:"item-playlist-name"},[t._v(t._s(t._f("showPlayListName")(e.name)))])])}),0):i("div",{staticClass:"item-playlist-none"},[t._v("暂无数据")])],2),t._v(" "),i("el-collapse-item",{staticClass:"border-opacity",attrs:{name:"2"}},[i("template",{slot:"title"},[t._v("\n                                收藏的歌单\n                                "),i("i",{staticClass:"el-icon-circle-plus-outline add-playlist",on:{click:function(e){return t.addPlaylistCollection(e)}}})]),t._v(" "),t.playlist_collection.length>0?i("div",t._l(t.playlist_collection,function(e){return i("div",{key:e.name,staticClass:"item-playlist",attrs:{title:t._f("showPlayListName")(e.name)},on:{click:function(i){return t.showPlaylist(i,e.name,e.address)}}},[i("i",{staticClass:"el-icon-lollipop item-playlist-icon"}),t._v(" "),i("div",{staticClass:"item-playlist-name"},[t._v(t._s(t._f("showPlayListName")(e.name)))])])}),0):i("div",{staticClass:"item-playlist-none"},[t._v("暂无数据")])],2)],1),t._v(" "),i("div",{staticClass:"music-mini"},[i("div",{staticClass:"music-mini-img",style:t.background_img},[i("div",{staticClass:"music-mini-btn",on:{click:function(e){t.show_lyrics_board=!0},mouseover:function(t){t.currentTarget.style.opacity=1},mouseleave:function(t){t.currentTarget.style.opacity=0}}},[i("i",{staticClass:"fas fa-angle-double-up"})])]),t._v(" "),i("div",{staticClass:"music-mini-msg"},[t._v(t._s(t.tips_msg))])])],1)],1)],1),t._v(" "),"已下载的音乐"==t.playlist_select_name?i("el-col",{staticClass:"playlist-content",attrs:{span:18}},[i("el-row",[i("el-col",{staticClass:"operate-download",attrs:{span:24}},[i("el-popconfirm",{attrs:{"confirm-button-text":"是的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"清除所有缓存的图片？"},on:{confirm:function(e){return t.deleteCacheFile("img_")}}},[i("el-button",{staticClass:"popover-btn",attrs:{slot:"reference",type:"primary",size:"small",icon:"el-icon-picture-outline-round"},slot:"reference"},[t._v("清理图片\n                        ")])],1),t._v(" "),i("el-popconfirm",{attrs:{"confirm-button-text":"是的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"清除所有缓存的歌词？"},on:{confirm:function(e){return t.deleteCacheFile("lyrics_")}}},[i("el-button",{staticClass:"popover-btn",attrs:{slot:"reference",type:"primary",size:"small",icon:"el-icon-takeaway-box"},slot:"reference"},[t._v("\n                            清理歌词\n                        ")])],1),t._v(" "),i("el-popconfirm",{attrs:{"confirm-button-text":"是的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"清除所有下载的歌曲？"},on:{confirm:function(e){return t.deleteCacheFile("download_")}}},[i("el-button",{staticClass:"popover-btn",attrs:{slot:"reference",type:"primary",size:"small",icon:"el-icon-headset"},slot:"reference"},[t._v("清理下载\n                        ")])],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-table",{staticClass:"border-opacity mini-scroll-table",attrs:{data:t.download_table.filter(function(e){return!t.search_music||e.name.toLowerCase().includes(t.search_music.toLowerCase())}),height:"572"}},[i("el-table-column",{staticClass:"item-playlist-name",attrs:{prop:"name"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{attrs:{slot:"reference"},slot:"reference"},[i("i",{staticClass:"el-icon-circle-check download-icon"}),t._v("\n                                    "+t._s(t._f("showDownloadName")(e.row.name))+"\n                                ")])]}}],null,!1,1991380274)},[i("template",{slot:"header"},[t._v("\n                                音乐标题\n                                "),i("el-input",{staticClass:"search-music",attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:t.search_music,callback:function(e){t.search_music=e},expression:"search_music"}})],1)],2),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"music-operate"},[i("i",{staticClass:"el-icon-video-play operate-item music-operate-play",on:{click:function(i){return t.addDownloadToPlay(e.row)}}}),t._v(" "),i("el-popover",{ref:"playlist-popover-"+e.$index,attrs:{placement:"left",trigger:"click"}},[i("div",{staticClass:"pop-add-content"},[i("div",{staticClass:"pop-add-title"},[t._v("收藏至歌单")]),t._v(" "),t.playlist_own.length>0?i("div",t._l(t.playlist_own,function(a){return i("div",{key:a.name,staticClass:"pop-add-item",on:{click:function(i){return t.addDownloadToPlaylist(a.name,e.row,"playlist-popover-"+e.$index)}}},[i("i",{staticClass:"el-icon-milk-tea item-playlist-icon"}),t._v(" "),i("div",{staticClass:"item-playlist-name"},[t._v(t._s(t._f("showPlayListName")(a.name)))])])}),0):i("div",[i("div",{staticClass:"pop-add-item disabled"},[t._v("怎么没有歌单")])])]),t._v(" "),i("i",{staticClass:"el-icon-folder-add operate-item music-operate-more",attrs:{slot:"reference"},slot:"reference"})]),t._v(" "),i("el-popconfirm",{attrs:{"confirm-button-text":"删了","cancel-button-text":"留着吧",icon:"el-icon-info","icon-color":"red",title:"真的要删除下载？"},on:{confirm:function(i){return t.removeDownload(e.row.name)}}},[i("i",{staticClass:"el-icon-delete delete-download",attrs:{slot:"reference"},slot:"reference"})])],1)]}}],null,!1,382251981)})],1)],1)],1)],1):""!=t.playlist_select_name?i("el-col",{staticClass:"playlist-content",attrs:{span:18}},[i("el-row",[i("el-col",{attrs:{span:4}},[i("el-image",{staticClass:"playlist-img",attrs:{src:t.playlist_img}},[i("div",{attrs:{slot:"error"},slot:"error"},[i("el-image",{staticClass:"playlist-img",attrs:{fit:"scale-down",src:t.error_img}})],1)])],1),t._v(" "),i("el-col",{attrs:{span:20}},[i("el-row",[i("el-col",{staticClass:"playlist-title"},[i("el-tag",{attrs:{size:"small",type:"danger"}},[t._v("歌单")]),t._v(" "),i("div",{staticClass:"item-playlist-name"},[t._v(t._s(t._f("showPlayListName")(t.playlist_select_name)))]),t._v(" "),i("div",{staticClass:"playlist-name-num"},[t._v("歌曲数: "+t._s(t.playlist_content.length))])],1)],1),t._v(" "),i("el-row",[i("el-col",{staticClass:"playlist-sub-title"},[t._v("这个人很懒，什么都没有留下")])],1),t._v(" "),i("el-row",[i("el-col",{staticClass:"playlist-operate"},[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-caret-right"},on:{click:t.startPlaylist}},[t._v("播放全部\n                            ")]),t._v(" "),""!=t.playlist_select_api?i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:function(e){return t.syncPlaylist(t.playlist_select_name,t.playlist_select_api)}}},[t._v("同步歌单\n                            ")]):t._e(),t._v(" "),i("el-popconfirm",{attrs:{"confirm-button-text":"真的","cancel-button-text":"算了",icon:"el-icon-info","icon-color":"red",title:"真的要删除这个歌单吗？"},on:{confirm:function(e){return t.deletePlaylist(t.playlist_select_name)}}},[i("el-button",{staticClass:"popover-btn",attrs:{slot:"reference",type:"primary",size:"small",icon:"el-icon-close"},slot:"reference"},[t._v("\n                                    删除歌单\n                                ")])],1)],1)],1)],1)],1),t._v(" "),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-table",{staticClass:"border-opacity mini-scroll-table",attrs:{data:t.playlist_content.filter(function(e){return!t.search_music||e.name.toLowerCase().includes(t.search_music.toLowerCase())}),height:"500"}},[i("el-table-column",{staticClass:"item-playlist-name",attrs:{prop:"name","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"item-playlist-name",attrs:{slot:"reference"},slot:"reference"},[t.hasDownload(e.row.name)?i("i",{staticClass:"el-icon-circle-check download-icon"}):i("i",{staticClass:"el-icon-download download-icon",on:{click:function(i){return t.downloadMusic(i,e.row)}}}),t._v("\n                                    "+t._s(e.row.name)+"\n                                ")])]}}])},[i("template",{slot:"header"},[t._v("\n                                音乐标题\n                                "),i("el-input",{staticClass:"search-music",attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:t.search_music,callback:function(e){t.search_music=e},expression:"search_music"}})],1)],2),t._v(" "),i("el-table-column",{attrs:{label:"大小",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"item-playlist-name",attrs:{slot:"reference"},slot:"reference"},[t._v("\n                                    "+t._s((e.row.size/1024/1024).toFixed(2)+"M")+"\n                                ")])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"music-operate"},[i("i",{staticClass:"el-icon-video-play operate-item music-operate-play",on:{click:function(i){return t.addToPlay(e.row)}}}),t._v(" "),i("el-popover",{ref:"playlist-popover-"+e.$index,attrs:{placement:"left",trigger:"click"}},[i("div",{staticClass:"pop-add-content"},[i("div",{staticClass:"pop-add-title"},[t._v("收藏至歌单")]),t._v(" "),t.playlist_own.length>0?i("div",t._l(t.playlist_own,function(a){return i("div",{key:a.name,staticClass:"pop-add-item",on:{click:function(i){return t.addToPlaylist(a.name,e.row,"playlist-popover-"+e.$index)}}},[i("i",{staticClass:"el-icon-milk-tea item-playlist-icon"}),t._v(" "),i("div",{staticClass:"item-playlist-name"},[t._v(t._s(t._f("showPlayListName")(a.name)))])])}),0):i("div",[i("div",{staticClass:"pop-add-item disabled"},[t._v("怎么没有歌单")])])]),t._v(" "),i("i",{staticClass:"el-icon-folder-add operate-item music-operate-more",attrs:{slot:"reference"},slot:"reference"})]),t._v(" "),i("el-popconfirm",{attrs:{"confirm-button-text":"好的","cancel-button-text":"不了",icon:"el-icon-info","icon-color":"red",title:"从歌单中删除？"},on:{confirm:function(i){return t.removeFromPlaylist(t.playlist_select_name,e.row)}}},[i("i",{staticClass:"el-icon-delete operate-item music-operate-delete",attrs:{slot:"reference"},slot:"reference"})])],1)]}}])})],1)],1)],1)],1):i("el-col",{staticClass:"playlist-content",attrs:{span:18}},[i("el-empty",{attrs:{description:"请选择歌单"}})],1)],1),t._v(" "),i("div",{staticClass:"music-control"},[i("el-button",{staticClass:"music-control-btn small-btn",attrs:{type:"primary",circle:""},on:{click:t.preMusic}},[i("i",{staticClass:"fas fa-step-backward"})]),t._v(" "),i("el-button",{staticClass:"music-control-btn medium-btn",attrs:{type:"primary",circle:""},on:{click:t.playMusic}},[1==t.status?i("i",{staticClass:"fas fa-pause"}):i("i",{staticClass:"fas fa-play"})]),t._v(" "),i("el-button",{staticClass:"music-control-btn small-btn",attrs:{type:"primary",circle:""},on:{click:t.nextMusic}},[i("i",{staticClass:"fas fa-step-forward"})]),t._v(" "),i("el-button",{staticClass:"music-control-btn small-btn",attrs:{type:"primary",circle:""},on:{click:function(e){return t.stopMusic(!0)}}},[i("i",{staticClass:"fas fa-stop"})]),t._v(" "),i("div",{staticClass:"music-progress-container"},[i("span",[t._v(t._s(t._f("formatSeconds")(t.current_time)))]),t._v(" "),i("el-progress",{staticClass:"music-progress",attrs:{percentage:t.percentage,"show-text":!1}}),t._v(" "),i("span",[t._v(t._s(t._f("formatSeconds")(t.duration_time)))])],1),t._v(" "),i("div",{staticClass:"music-volume-container"},[i("el-button",{staticClass:"volume-control-button control-button small-btn",attrs:{plain:""},on:{click:t.mutedPage}},[t.muted?i("i",{staticClass:"fas fa-volume-off"}):i("i",{staticClass:"fas fa-volume-up"})]),t._v(" "),i("div",{staticClass:"volume-bar"},[i("el-slider",{attrs:{"show-tooltip":!1},on:{input:t.resizeVolume},model:{value:t.volume,callback:function(e){t.volume=e},expression:"volume"}})],1),t._v(" "),i("el-button",{staticClass:"control-button small-btn",attrs:{plain:""},on:{click:t.switchModel}},[0===t.play_model?i("i",{staticClass:"fas fa-sort-numeric-down"}):1===t.play_model?i("i",{staticClass:"fas fa-undo"}):i("i",{staticClass:"fas fa-random"})]),t._v(" "),i("el-popover",{attrs:{placement:"top-end",width:"800",trigger:"click"}},[t.music_list.length>0?i("div",{staticClass:"music-list"},t._l(t.music_list,function(e,a){return i("div",{key:e.sha,attrs:{index:a},on:{click:function(i){return t.getMusicContent(i,e)}}},[t._v("\n                        "+t._s(a+1)+". "+t._s(e.name)+" ( "+t._s((e.size/1024/1024).toFixed(2)+"M")+" )\n                    ")])}),0):i("div",[i("el-empty",{attrs:{description:"暂无数据"}})],1),t._v(" "),i("el-button",{staticClass:"control-button small-btn",attrs:{slot:"reference",plain:""},slot:"reference"},[i("i",{staticClass:"fas fa-th-list"})])],1)],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"收藏歌单",visible:t.dialogCollectionVisible,"append-to-body":!0,width:"800px"},on:{"update:visible":function(e){t.dialogCollectionVisible=e}}},[i("el-form",{ref:"collectionForm",attrs:{model:t.collectionForm,rules:t.collectionFormRules,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"歌单名称",prop:"name"}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:t.collectionForm.name,callback:function(e){t.$set(t.collectionForm,"name",e)},expression:"collectionForm.name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"歌单地址"}},[i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{prop:"username"}},[i("el-input",{attrs:{autocomplete:"off",placeholder:"用户名"},model:{value:t.collectionForm.username,callback:function(e){t.$set(t.collectionForm,"username",e)},expression:"collectionForm.username"}})],1)],1),t._v(" "),i("el-col",{staticClass:"line-center",attrs:{span:1}},[t._v("/")]),t._v(" "),i("el-col",{attrs:{span:5}},[i("el-form-item",{attrs:{prop:"repo"}},[i("el-input",{attrs:{autocomplete:"off",placeholder:"仓库名"},model:{value:t.collectionForm.repo,callback:function(e){t.$set(t.collectionForm,"repo",e)},expression:"collectionForm.repo"}})],1)],1),t._v(" "),i("el-col",{staticClass:"line-center",attrs:{span:1}},[t._v("/")]),t._v(" "),i("el-col",{attrs:{span:12}},[i("el-input",{attrs:{prop:"path",autocomplete:"off",placeholder:"仓库内路径( /xxx/xx ) 也可以不填"},model:{value:t.collectionForm.path,callback:function(e){t.$set(t.collectionForm,"path",e)},expression:"collectionForm.path"}})],1)],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:t.addPlaylistCollectionCancel}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.addPlaylistCollectionConfirm}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var I=i("VU/8")(S,T,!1,function(t){i("4i06")},"data-v-1ac20d41",null).exports,N={name:"AppPicture",data:function(){return{pictureApi:"https://api.github.com/repos/onedx1943/Picture/contents",pictureList:[],defaultImg:"data:image/jpeg;base64,",observer:null,observedList:[]}},watch:{pictureList:function(t){this.addToObserve()}},computed:{pictureColumn0:function(){return this.pictureList.filter(function(t,e){return e%5==0})},pictureColumn1:function(){return this.pictureList.filter(function(t,e){return e%5==1})},pictureColumn2:function(){return this.pictureList.filter(function(t,e){return e%5==2})},pictureColumn3:function(){return this.pictureList.filter(function(t,e){return e%5==3})},pictureColumn4:function(){return this.pictureList.filter(function(t,e){return e%5==4})}},created:function(){this.loadData(this.pictureApi)},mounted:function(){var t=this;t.observer=new IntersectionObserver(function(e){e.forEach(function(e){if(e.isIntersecting){var i=e.target,a=i.getAttribute("data-name"),n=i.getAttribute("data-show-src");t.getImage(a,"show_url",n,i),t.observer.unobserve(i)}})},{threshold:0}),t.addToObserve()},methods:{loadData:function(t){var e=this;this.$http.get(t,{headers:{Authorization:e.$token1+e.$token2+e.$token3}}).then(function(t){e.limitNotification(t.headers);for(var i=0;i<t.data.length;i++)"file"===t.data[i].type&&(t.data[i].name.endsWith(".gif")||t.data[i].name.endsWith(".png"))?t.data[i].name.endsWith(".gif")?e.pictureList.push({show_url:t.data[i].download_url.substring(0,t.data[i].download_url.lastIndexOf("."))+".jpg",id:t.data[i].sha,name:t.data[i].name,preview_url:t.data[i].download_url.substring(0,t.data[i].download_url.lastIndexOf("."))+".mp4",download_url:t.data[i].download_url,show_img:"data:image/jpeg;base64,",is_gif:!0}):e.pictureList.push({show_url:t.data[i].download_url,id:t.data[i].sha,name:t.data[i].name,preview_url:t.data[i].download_url,download_url:t.data[i].download_url,show_img:"data:image/jpeg;base64,",is_gif:!1}):"dir"===t.data[i].type&&e.loadData(t.data[i].url)}).catch(function(t){e.$notify({type:"error",title:"错误",message:"API访问失败，请检查",offset:60}),console.log(t)})},limitNotification:function(t){var e=t["x-ratelimit-limit"],i=t["x-ratelimit-remaining"];parseInt(i)/parseInt(e)<.4&&this.$notify({type:"warning",title:"警告",message:"请求速率限制: "+i+"/"+e+"每小时",offset:60})},addToObserve:function(){var t=this;t.$nextTick(function(){document.querySelectorAll(".picture-item-container.wait-observer").forEach(function(e){e.classList.remove("wait-observer"),t.observer.observe(e)})})},getImage:function(t,e,i,a){var n=this,s="picture_"+t;this.$localforage.getItem(s).then(function(o){if(o&&o[e])n.changeImage(t,o[e],a);else{var l=i.split(".").pop().toLowerCase();n.getBase64ImageUrl(i,l,function(i){var o={};o[e]=i,n.$localforage.setItem(s,o).then(function(){n.changeImage(t,i,a),n.$parent.refreshUsage()})})}}).catch(function(t){console.log(t)})},changeImage:function(t,e,i){var a=this.pictureList.findIndex(function(e){return e.name===t});a>0&&(this.pictureList[a].show_img=e),i.classList.remove("height-max")},getBase64ImageUrl:function(t,e,i){var a=new XMLHttpRequest;a.responseType="arraybuffer",a.open("GET",t,!0),a.onload=function(){var t=a.response,n=new File([t],"image."+e,{type:"image/"+e}),s=new FileReader;s.onload=function(t){i(t.target.result)},s.readAsDataURL(n)},a.send(null)}}},F={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-row",{staticClass:"picture-wrapper main-content"},[i("el-col",{staticClass:"picture-container mini-scroll"},[i("div",{staticClass:"picture-column-wrapper"},[i("div",{staticClass:"picture-column"},t._l(t.pictureColumn0,function(e){return i("div",{key:e.id,staticClass:"picture-item-container wait-observer height-max",attrs:{"data-name":e.name,"data-show-src":e.show_url}},[i("el-image",{staticClass:"picture-item",attrs:{fit:"scale-down",src:e.show_img}},[i("div",{staticClass:"image-placeholder",attrs:{slot:"placeholder"},slot:"placeholder"},[i("i",{staticClass:"el-icon-picture-outline"})]),t._v(" "),i("div",{staticClass:"image-error",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])])],1)}),0),t._v(" "),i("div",{staticClass:"picture-column"},t._l(t.pictureColumn1,function(e){return i("div",{key:e.id,staticClass:"picture-item-container wait-observer height-max",attrs:{"data-name":e.name,"data-show-src":e.show_url}},[i("el-image",{staticClass:"picture-item",attrs:{fit:"scale-down",src:e.show_img}},[i("div",{staticClass:"image-placeholder",attrs:{slot:"placeholder"},slot:"placeholder"},[i("i",{staticClass:"el-icon-picture-outline"})]),t._v(" "),i("div",{staticClass:"image-error",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])])],1)}),0),t._v(" "),i("div",{staticClass:"picture-column"},t._l(t.pictureColumn2,function(e){return i("div",{key:e.id,staticClass:"picture-item-container wait-observer height-max",attrs:{"data-name":e.name,"data-show-src":e.show_url}},[i("el-image",{staticClass:"picture-item",attrs:{fit:"scale-down",src:e.show_img}},[i("div",{staticClass:"image-placeholder",attrs:{slot:"placeholder"},slot:"placeholder"},[i("i",{staticClass:"el-icon-picture-outline"})]),t._v(" "),i("div",{staticClass:"image-error",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])])],1)}),0),t._v(" "),i("div",{staticClass:"picture-column"},t._l(t.pictureColumn3,function(e){return i("div",{key:e.id,staticClass:"picture-item-container wait-observer height-max",attrs:{"data-name":e.name,"data-show-src":e.show_url}},[i("el-image",{staticClass:"picture-item",attrs:{fit:"scale-down",src:e.show_img}},[i("div",{staticClass:"image-placeholder",attrs:{slot:"placeholder"},slot:"placeholder"},[i("i",{staticClass:"el-icon-picture-outline"})]),t._v(" "),i("div",{staticClass:"image-error",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])])],1)}),0),t._v(" "),i("div",{staticClass:"picture-column"},t._l(t.pictureColumn4,function(e){return i("div",{key:e.id,staticClass:"picture-item-container wait-observer height-max",attrs:{"data-name":e.name,"data-show-src":e.show_url}},[i("el-image",{staticClass:"picture-item",attrs:{fit:"scale-down",src:e.show_img}},[i("div",{staticClass:"image-placeholder",attrs:{slot:"placeholder"},slot:"placeholder"},[i("i",{staticClass:"el-icon-picture-outline"})]),t._v(" "),i("div",{staticClass:"image-error",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"el-icon-picture-outline"})])])],1)}),0)]),t._v(" "),i("div",{staticClass:"picture-load-more"})])],1)},staticRenderFns:[]};var A=i("VU/8")(N,F,!1,function(t){i("A4AV")},"data-v-36d9b350",null).exports,M=(i("qiEZ"),i("Bkjw")),D=i.n(M),P=i("sctN"),z=i.n(P),U={name:"AppVideo",filters:{},data:function(){return{activeNames:["1"],video_api:"https://api.github.com/repos/onedx1943/Music/contents",custom_api:"https://api.github.com/repos/onedx1943/Music/contents",video_list:[],video_msg:"正在读取文件...",filterText:"",videoPlayer:null}},watch:{filterText:function(t){this.filter_video(t.toLowerCase())}},computed:{},mounted:function(){this.getVideoList(this.video_api)},beforeDestroy:function(){this.stopVideo()},methods:{getVideoList:function(t){var e=this;e.video_msg="正在查找文件！",e.$http.get(t,{headers:{Authorization:e.$token1+e.$token2+e.$token3}}).then(function(i){e.limitNotification(i.headers);for(var a=0;a<i.data.length;a++)if(i.data[a].name.endsWith(".mp4"))e.video_list.push(i.data[a]);else if("dir"===i.data[a].type){var n=t+"/"+i.data[a].name;e.getVideoList(n)}}).catch(function(t){console.log(t),e.video_msg="网络或者链接有问题啊，读取失败了！"})},getVideoContent:function(t,e){document.querySelector(".video-list .active-video")&&document.querySelector(".video-list .active-video").classList.remove("active-video"),t.currentTarget.classList.add("active-video");parseInt(t.currentTarget.getAttribute("index"));this.videoPlayer=new D.a({container:"#mui-player",title:e.name,src:e.download_url,themeColor:"#409EFF",plugins:[new z.a]})},limitNotification:function(t){var e=t["x-ratelimit-limit"],i=t["x-ratelimit-remaining"];parseInt(i)/parseInt(e)<.4&&this.$notify({type:"warning",title:"警告",message:"请求速率限制: "+i+"/"+e+"每小时",offset:60})},stopVideo:function(){this.videoPlayer&&this.videoPlayer.destory()},loadCustomApi:function(){var t=new RegExp(this.$apiReg,"i");this.video_list=[],this.filterText="",t.test(this.custom_api)?this.getVideoList(this.custom_api):this.video_msg="链接格式：https://api.github.com/repos/用户名/仓库名/contents（仓库内具体路径可以接着加 /xxx/xxx）"},filter_video:function(t){document.querySelectorAll(".video-list div").forEach(function(e){e.innerText.toLowerCase().includes(t)?e.style.display="block":e.style.display="none"})}}},q={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"main-content"},[i("el-row",[i("el-col",[i("div",{staticClass:"video-header"},[i("div",{staticClass:"video-custom"},[i("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.custom_api,callback:function(e){t.custom_api=e},expression:"custom_api"}},[i("template",{slot:"prepend"},[t._v("从自定义github仓获取视频")]),t._v(" "),i("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.loadCustomApi},slot:"append"})],2)],1)])])],1),t._v(" "),t._m(0),t._v(" "),i("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"仅供搜索，别想太多",clearable:""},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}),t._v(" "),t.video_list.length>0?i("div",{staticClass:"video-list mini-scroll"},t._l(t.video_list,function(e,a){return i("div",{key:e.sha,attrs:{index:a},on:{click:function(i){return t.getVideoContent(i,e)}}},[t._v(t._s(a+1)+". "+t._s(e.name)+" ( "+t._s((e.size/1024/1024).toFixed(2)+"M")+" )\n        ")])}),0):i("div",[t._v(t._s(t.video_msg))])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"video-content"},[e("div",{attrs:{id:"mui-player"}})])}]};var R=i("VU/8")(U,q,!1,function(t){i("YZyE")},"data-v-9aff5c92",null).exports,V=i("mvHQ"),E=i.n(V),j=i("MICi"),H=i.n(j),B=i("5dBV"),O=i.n(B),W={name:"AppWorkHour",data:function(){return{start_date:new Date,work_hour:0,total_hour:0,date_list:[],today:new Date((new Date).toLocaleDateString()).getTime()}},computed:{workHourType:function(){var t=O()(this.total_hour);return H()(t)?"":t>4?"success":t>=0?"warning":"danger"}},mounted:function(){var t=new Date(new Date((new Date).toLocaleDateString()).setDate(1)),e=t.getFullYear()+"/"+(t.getMonth()+1),i=localStorage.getItem(e);if(i){var a=JSON.parse(i);this.start_date=new Date(a.date),this.work_hour=a.work_hour}else this.start_date=t,this.work_hour=0;this.work_mouth_picker(this.start_date)},methods:{work_mouth_picker:function(t){this.start_date=t;var e=t.getFullYear()+"/"+(t.getMonth()+1),i=localStorage.getItem(e);if(i){var a=JSON.parse(i);a.date=t,this.work_hour=a.work_hour,localStorage.setItem(e,E()(a))}else{this.work_hour=0;var n={date:this.start_date,work_hour:this.work_hour};localStorage.setItem(e,E()(n))}this.setShowDate(new Date(t))},init_work_hour:function(t){var e=this.start_date.getFullYear()+"/"+(this.start_date.getMonth()+1),i=localStorage.getItem(e);if(i){var a=JSON.parse(i);a.work_hour=t,localStorage.setItem(e,E()(a))}else{var n={date:this.start_date,work_hour:this.work_hour};localStorage.setItem(e,E()(n))}this.calculateTotalHour()},setShowDate:function(t){this.date_list=[];var e=this.getDaysOfMouth(t);if(0!==e.length){var i=e[0].getDay(),a=0;a=0===i?6:i-1;for(var n=0;n<a;n++)this.date_list.unshift({is_current_month:!1,date:new Date(e[0].getTime()-864e5*(n+1)).toLocaleDateString(),need_calculate:!1});var s=!0,o=!1,l=void 0;try{for(var r,c=y()(e);!(s=(r=c.next()).done);s=!0){var u=r.value,d=[new Date(u.toLocaleDateString()+" 09:00:00").getTime()];[1,4].includes(u.getDay())?d.push(new Date(u.toLocaleDateString()+" 20:30:00").getTime()):d.push(new Date(u.toLocaleDateString()+" 17:30:00").getTime());var m=!0,p=this.calculateWorkHour(d);[0,6].includes(u.getDay())&&(m=!1);var f=localStorage.getItem(u.toLocaleDateString());if(f){var v=JSON.parse(f);d=v.time_range,m=v.need_calculate,p=v.account_time}this.date_list.push({is_current_month:!0,date:u.toLocaleDateString(),time_range:d,account_time:p,need_calculate:m})}}catch(t){o=!0,l=t}finally{try{!s&&c.return&&c.return()}finally{if(o)throw l}}0===(i=this.date_list.length%7)?0:7-i;for(var h=42-this.date_list.length,_=0;_<h;_++)this.date_list.push({is_current_month:!1,date:new Date(e[e.length-1].getTime()+864e5*(_+1)).toLocaleDateString(),need_calculate:!1});this.calculateTotalHour()}},getDaysOfMouth:function(t){for(var e=t.setDate(1),i=t.getMonth()+1,a=new Date(t.getFullYear(),i,1).getTime(),n=[],s=e;s<a;s+=864e5)n.push(new Date(s));return n},dateFormat:function(t){var e=new Date(t);return e.getMonth()+1+"-"+e.getDate()},significantDigits:function(t){var e=O()(t);return H()(e)?"00":e<10?"0"+e:""+e},timeFormat:function(t){return t?this.significantDigits(new Date(t[0]).getHours().toString())+":"+this.significantDigits(new Date(t[0]).getMinutes().toString())+" - "+this.significantDigits(new Date(t[1]).getHours().toString())+":"+this.significantDigits(new Date(t[1]).getMinutes().toString()):""},switchCalculate:function(t,e){var i=localStorage.getItem(e.date);if(i){var a=JSON.parse(i);a.need_calculate=t,localStorage.setItem(e.date,E()(a))}else{var n={time_range:e.time_range,account_time:e.account_time,need_calculate:t};localStorage.setItem(e.date,E()(n))}this.calculateTotalHour()},calculateToday:function(t,e){e.account_time=this.calculateWorkHour(t);var i=localStorage.getItem(e.date);if(i){var a=JSON.parse(i);a.time_range=t,a.account_time=e.account_time,localStorage.setItem(e.date,E()(a))}else{var n={time_range:e.time_range,account_time:e.account_time,need_calculate:!0};localStorage.setItem(e.date,E()(n))}this.calculateTotalHour()},calculateWorkHour:function(t){var e=0;if(t){var i=new Date(t[0]).getHours(),a=new Date(t[0]).getMinutes(),n=new Date(t[0]).getSeconds();if(i<8)i=8,a=0,n=0;else if(12===i||13===i&&a<30)i=13,a=30,n=0;else if(i>17)return e;var s=new Date(t[1]).getHours(),o=new Date(t[1]).getMinutes(),l=new Date(t[1]).getSeconds();if(17===s&&o>=30)s=17,o=30,l=0;else if(12===s||13===s&&o<30)s=12,o=0,l=0;else if(s<8)return e;return e=3600*(s-i)+60*(o-a)+(l-n),i<12&&s>12&&(e-=5400),i<18&&s>17&&(e-=1800),(e/3600).toFixed(2)}return e},calculateTotalHour:function(){var t=O()(this.work_hour);H()(t)&&(t=0);var e=!0,i=!1,a=void 0;try{for(var n,s=y()(this.date_list);!(e=(n=s.next()).done);e=!0){var o=n.value;o.need_calculate&&new Date(o.date).getTime()>=new Date(this.start_date).getTime()&&(t+=O()(o.account_time)-8)}}catch(t){i=!0,a=t}finally{try{!e&&s.return&&s.return()}finally{if(i)throw a}}this.total_hour=t.toFixed(2)}}},Y={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"main-content"},[i("el-form",{attrs:{"label-position":"right","label-width":"160px"}},[i("el-form-item",{attrs:{label:"开始统计时间："}},[i("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",clearable:!1,editable:!1,"picker-options":{firstDayOfWeek:1}},on:{change:function(e){return t.work_mouth_picker(e)}},model:{value:t.start_date,callback:function(e){t.start_date=e},expression:"start_date"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"初始工时："}},[i("el-input",{staticClass:"work_hour_input",attrs:{placeholder:"请输入内容"},on:{change:function(e){return t.init_work_hour(e)}},model:{value:t.work_hour,callback:function(e){t.work_hour=e},expression:"work_hour"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"结算工时："}},[i("el-tag",{attrs:{effect:"dark",type:t.workHourType}},[t._v(t._s(t.total_hour))])],1)],1),t._v(" "),i("el-divider"),t._v(" "),t.date_list.length>0?i("div",{staticClass:"date-list"},[t._l(["一","二","三","四","五","六","日"],function(e){return i("div",{key:e,staticClass:"title-content"},[t._v(t._s(e)+"\n        ")])}),t._v(" "),t._l(t.date_list,function(e){return i("div",{key:e.date,staticClass:"date-content",class:{current_month:e.is_current_month,today:new Date(e.date).getTime()==t.today,yesterday:new Date(e.date).getTime()<t.today}},[i("div",{staticClass:"date-content-row"},[i("div",[t._v(t._s(t.dateFormat(e.date)))]),t._v(" "),i("div",[e.is_current_month?i("el-switch",{on:{change:function(i){return t.switchCalculate(i,e)}},model:{value:e.need_calculate,callback:function(i){t.$set(e,"need_calculate",i)},expression:"date.need_calculate"}}):t._e()],1)]),t._v(" "),e.is_current_month&&e.need_calculate?i("div",{staticClass:"date-content-row"},[i("div",{staticClass:"account_time"},[i("el-tag",[t._v(t._s(e.account_time))])],1)]):t._e(),t._v(" "),e.is_current_month&&e.need_calculate?i("div",{staticClass:"date-content-row"},[i("div",[i("el-popover",{attrs:{width:"350",trigger:"click"}},[i("div",{staticClass:"date-setting"},[i("el-time-picker",{attrs:{"is-range":"",clearable:!1,"range-separator":"至"},on:{change:function(i){return t.calculateToday(i,e)}},model:{value:e.time_range,callback:function(i){t.$set(e,"time_range",i)},expression:"date.time_range"}})],1),t._v(" "),i("div",{attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(t.timeFormat(e.time_range)))])])],1)]):t._e()])})],2):t._e()],1)},staticRenderFns:[]};var J=i("VU/8")(W,Y,!1,function(t){i("WAT3")},"data-v-db508c4a",null).exports,G={name:"Blog",components:{pageHeader:d},data:function(){return{msg:"瞅啥呢，这里啥也没有啊 ʅ（´◔౪◔）ʃ"}},methods:{}},Q={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"page-container"},[e("pageHeader"),this._v(" "),e("div",{staticClass:"page-blog"},[e("div",{staticClass:"blog-container"},[e("div",[this._v("这是Blog页")]),this._v(" "),e("div",[this._v(this._s(this.msg))])])])],1)},staticRenderFns:[]};var K=i("VU/8")(G,Q,!1,function(t){i("6aIQ")},"data-v-ebf3951e",null).exports;a.default.use(o.a);var X=new o.a({routes:[{path:"/",component:r},{path:"/app",component:f,children:[{path:"/",component:h},{path:"icon",component:C},{path:"novel",component:$},{path:"music",component:I},{path:"picture",component:A},{path:"video",component:R},{path:"work-hour",component:J}]},{path:"/blog",component:K}]}),Z=i("zL8q"),tt=i.n(Z),et=(i("tvR6"),i("mtWM")),it=i.n(et),at=(i("M4fF"),i("22C0")),nt=i.n(at);i("ao2D"),i("Q0/0");a.default.config.productionTip=!1,a.default.use(tt.a);a.default.prototype.$token1="token ",a.default.prototype.$token2="ghp_ViEN3xDs7cbQSHju",a.default.prototype.$token3="BJqYFdf6esKqHL3kRP6l",a.default.prototype.$apiReg="^https://api.github.com/repos/[0-9a-z_!~*'().&=+$%-]+/[0-9a-z_!~*'().&=+$%-]+/contents(/[0-9a-z一-龥_!~*'().&=+$%-]+)*$",a.default.prototype.$http=it.a,a.default.prototype.$localforage=nt.a,new a.default({el:"#app",router:X,components:{App:s},template:"<App/>"})},"Q0/0":function(t,e){},WAT3:function(t,e){},YZyE:function(t,e){},ao2D:function(t,e){},p6uz:function(t,e){},qFEt:function(t,e){},qiEZ:function(t,e){},tvR6:function(t,e){},wI6D:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.f8cfd9e10eda45fa0b5d.js.map